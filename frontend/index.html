<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Omar's Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState } = React;

        // Icons
        const MusicIcon = ({ className = "w-16 h-16" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
            </svg>
        );

        const VideoIcon = ({ className = "w-16 h-16" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
        );

        const CodeIcon = ({ className = "w-16 h-16" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
            </svg>
        );

        const HomeIcon = () => (
            <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
        );

        const ClearIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
        );

        const App = () => {
            const [currentPage, setCurrentPage] = useState('home');

            return (
                <>
                    {currentPage === 'home' && <HomePage setCurrentPage={setCurrentPage} />}
                    {currentPage === 'youtube' && <YouTubePage setCurrentPage={setCurrentPage} />}
                    {currentPage === 'video-downloader' && <VideoDownloaderPage setCurrentPage={setCurrentPage} />}
                    {currentPage === 'converter' && <ConverterPage setCurrentPage={setCurrentPage} />}
                </>
            );
        };

        // HOME PAGE
        const HomePage = ({ setCurrentPage }) => {
            const tools = [
                {
                    id: 'youtube',
                    name: 'YouTube Music',
                    description: 'Download music from YouTube',
                    icon: MusicIcon,
                    color: 'text-red-400'
                },
                {
                    id: 'video-downloader',
                    name: 'YouTube Video',
                    description: 'Download videos with quality selection',
                    icon: VideoIcon,
                    color: 'text-blue-400'
                },
                {
                    id: 'converter',
                    name: 'XML/JSON Converter',
                    description: 'Convert between XML and JSON',
                    icon: CodeIcon,
                    color: 'text-green-400'
                }
            ];

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-8">
                    <div className="text-center">
                        <h1 className="text-6xl font-bold text-white mb-4">Welcome Omar! ðŸ‘‹</h1>
                        <p className="text-xl text-purple-200 mb-12">Choose your tool</p>
                        
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl">
                            {tools.map(tool => (
                                <div 
                                    key={tool.id}
                                    onClick={() => setCurrentPage(tool.id)}
                                    className="bg-white/10 backdrop-blur-lg rounded-2xl p-8 cursor-pointer hover:bg-white/20 transition-all hover:scale-105 border border-white/20"
                                >
                                    <tool.icon className={`w-16 h-16 ${tool.color} mx-auto mb-4`} />
                                    <h3 className="text-2xl font-bold text-white mb-2">{tool.name}</h3>
                                    <p className="text-purple-200">{tool.description}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // YOUTUBE PAGE (Your existing YouTube component)
        const YouTubePage = ({ setCurrentPage }) => {
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [selectedVideo, setSelectedVideo] = useState(null);
            const [loading, setLoading] = useState(false);
            const [downloading, setDownloading] = useState(false);
            const [downloadProgress, setDownloadProgress] = useState(0);

            const isUrl = (text) => text.trim().startsWith('http');

            const handleSearch = async () => {
                if (!searchQuery.trim()) return;

                if (isUrl(searchQuery)) {
                    setLoading(true);
                    try {
                        const response = await fetch(`http://localhost:8000/api/youtube/video-info?url=${encodeURIComponent(searchQuery)}`);
                        const data = await response.json();
                        setSelectedVideo(data);
                        setSearchResults([]);
                    } catch (error) {
                        alert('Failed to fetch video info: ' + error.message);
                    }
                    setLoading(false);
                    return;
                }

                setLoading(true);
                setSelectedVideo(null);
                try {
                    const response = await fetch('http://localhost:8000/api/youtube/search', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: searchQuery })
                    });
                    const data = await response.json();
                    setSearchResults(data);
                } catch (error) {
                    alert('Search failed: ' + error.message);
                }
                setLoading(false);
            };

            const handleClear = () => {
                setSearchQuery('');
                setSearchResults([]);
                setSelectedVideo(null);
            };

            const handleDownload = async () => {
                if (!searchQuery.trim() || !isUrl(searchQuery)) return;

                setDownloading(true);
                setDownloadProgress(0);
                
                try {
                    const response = await fetch('http://localhost:8000/api/youtube/download', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ url: searchQuery })
                    });

                    if (!response.ok) throw new Error('Download failed');

                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = 'song.mp3';
                    if (contentDisposition) {
                        const patterns = [
                            /filename\*=UTF-8''(.+)/,
                            /filename="(.+)"/,
                            /filename=([^;\n]+)/
                        ];
                        
                        for (const pattern of patterns) {
                            const match = contentDisposition.match(pattern);
                            if (match && match[1]) {
                                filename = decodeURIComponent(match[1].trim());
                                break;
                            }
                        }
                    }

                    if (filename === 'song.mp3' && selectedVideo) {
                        const safeTitle = selectedVideo.title.replace(/[^a-z0-9]/gi, '_').replace(/_+/g, '_');
                        filename = `${safeTitle}.mp3`;
                    }

                    const contentLength = response.headers.get('Content-Length');
                    const total = parseInt(contentLength, 10);
                    let loaded = 0;

                    const reader = response.body.getReader();
                    const chunks = [];

                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        
                        chunks.push(value);
                        loaded += value.length;
                        
                        if (total) {
                            const progress = Math.round((loaded / total) * 100);
                            setDownloadProgress(progress);
                        }
                    }

                    const blob = new Blob(chunks);
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    setTimeout(() => {
                        alert('Download complete! âœ…');
                        setSearchQuery('');
                        setSearchResults([]);
                        setSelectedVideo(null);
                        setDownloadProgress(0);
                    }, 500);
                } catch (error) {
                    alert('Download failed: ' + error.message);
                    setDownloadProgress(0);
                }
                setDownloading(false);
            };

            const handleCardClick = (video) => {
                setSearchQuery(video.url);
                setSelectedVideo(video);
                setSearchResults([]);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex items-center mb-8">
                            <button 
                                onClick={() => { setCurrentPage('home'); setSearchQuery(''); setSearchResults([]); setSelectedVideo(null); }}
                                className="mr-6 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-colors border border-white/20"
                            >
                                <HomeIcon />
                            </button>
                            <h1 className="text-4xl font-bold text-white flex items-center gap-3">
                                <MusicIcon className="w-10 h-10 text-red-400" />
                                YouTube Music Downloader
                            </h1>
                        </div>

                        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-8 border border-white/20">
                            <div className="flex gap-3">
                                <input
                                    type="text"
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                    placeholder="Search for music or paste YouTube URL..."
                                    className="flex-1 bg-white/10 border border-white/20 rounded-xl px-6 py-4 text-white placeholder-purple-200/50 focus:outline-none focus:ring-2 focus:ring-purple-400"
                                />
                                {searchQuery && (
                                    <button
                                        onClick={handleClear}
                                        className="bg-red-600 hover:bg-red-700 p-4 rounded-xl text-white transition-colors"
                                        title="Clear"
                                    >
                                        <ClearIcon />
                                    </button>
                                )}
                                <button
                                    onClick={isUrl(searchQuery) ? handleDownload : handleSearch}
                                    disabled={loading || downloading || !searchQuery.trim()}
                                    className="bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 px-8 py-4 rounded-xl text-white font-semibold transition-colors disabled:cursor-not-allowed"
                                >
                                    {downloading ? 'Downloading...' : loading ? 'Loading...' : isUrl(searchQuery) && selectedVideo ? 'Download' : isUrl(searchQuery) ? 'Fetch Info' : 'Search'}
                                </button>
                            </div>
                            
                            {downloading && (
                                <div className="mt-4">
                                    <div className="w-full bg-white/10 rounded-full h-3 overflow-hidden">
                                        <div 
                                            className="bg-gradient-to-r from-purple-500 to-pink-500 h-full transition-all duration-300"
                                            style={{ width: `${downloadProgress}%` }}
                                        />
                                    </div>
                                    <p className="text-purple-200 text-sm text-center mt-2">{downloadProgress}%</p>
                                </div>
                            )}
                        </div>

                        {selectedVideo && (
                            <div className="mb-8 flex justify-center">
                                <div className="bg-white/10 backdrop-blur-lg rounded-xl overflow-hidden border border-white/20 max-w-md w-full">
                                    <div className="relative pb-[56.25%]">
                                        <img src={selectedVideo.thumbnail} alt={selectedVideo.title} className="absolute inset-0 w-full h-full object-cover" />
                                    </div>
                                    <div className="p-4">
                                        <h3 className="text-white font-semibold mb-2">{selectedVideo.title}</h3>
                                        <p className="text-purple-200 text-sm mb-1">{selectedVideo.channel}</p>
                                        <p className="text-purple-300 text-sm">{selectedVideo.duration}</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {searchResults.length > 0 && (
                            <div>
                                <h2 className="text-2xl font-bold text-white mb-4">Search Results</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {searchResults.map((result) => (
                                        <div
                                            key={result.id}
                                            onClick={() => handleCardClick(result)}
                                            className="bg-white/10 backdrop-blur-lg rounded-xl overflow-hidden cursor-pointer hover:bg-white/20 transition-all hover:scale-105 border border-white/20"
                                        >
                                            <div className="relative pb-[56.25%]">
                                                <img src={result.thumbnail} alt={result.title} className="absolute inset-0 w-full h-full object-cover" />
                                            </div>
                                            <div className="p-4">
                                                <h3 className="text-white font-semibold mb-2 line-clamp-2">{result.title}</h3>
                                                <p className="text-purple-200 text-sm mb-1">{result.channel}</p>
                                                <p className="text-purple-300 text-sm">{result.duration}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {searchResults.length === 0 && !loading && !selectedVideo && (
                            <div className="text-center py-20">
                                <svg className="w-20 h-20 text-purple-300/30 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                                <p className="text-purple-200/50 text-lg">Search for music or paste a YouTube URL to get started</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // VIDEO DOWNLOADER PAGE
        const VideoDownloaderPage = ({ setCurrentPage }) => {
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [selectedVideo, setSelectedVideo] = useState(null);
            const [availableFormats, setAvailableFormats] = useState([]);
            const [selectedFormat, setSelectedFormat] = useState(null);
            const [loading, setLoading] = useState(false);
            const [loadingFormats, setLoadingFormats] = useState(false);
            const [downloading, setDownloading] = useState(false);
            const [downloadProgress, setDownloadProgress] = useState(0);

            const isUrl = (text) => text.trim().startsWith('http');

            const handleSearch = async () => {
                if (!searchQuery.trim()) return;

                if (isUrl(searchQuery)) {
                    setLoading(true);
                    try {
                        const response = await fetch(`http://localhost:8000/api/youtube/video-info?url=${encodeURIComponent(searchQuery)}`);
                        const data = await response.json();
                        setSelectedVideo(data);
                        setSearchResults([]);
                        await fetchFormats(searchQuery);
                    } catch (error) {
                        alert('Failed to fetch video info: ' + error.message);
                    }
                    setLoading(false);
                    return;
                }

                setLoading(true);
                setSelectedVideo(null);
                setAvailableFormats([]);
                try {
                    const response = await fetch('http://localhost:8000/api/youtube/search', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: searchQuery })
                    });
                    const data = await response.json();
                    setSearchResults(data);
                } catch (error) {
                    alert('Search failed: ' + error.message);
                }
                setLoading(false);
            };

            const handleClear = () => {
                setSearchQuery('');
                setSearchResults([]);
                setSelectedVideo(null);
                setAvailableFormats([]);
                setSelectedFormat(null);
            };

            const fetchFormats = async (url) => {
                setLoadingFormats(true);
                try {
                    const response = await fetch(`http://localhost:8000/api/youtube/video-formats?url=${encodeURIComponent(url)}`);
                    const formats = await response.json();
                    setAvailableFormats(formats);
                    if (formats.length > 0) {
                        setSelectedFormat(formats[0].format_id);
                    }
                } catch (error) {
                    alert('Failed to fetch formats: ' + error.message);
                }
                setLoadingFormats(false);
            };

            const handleDownload = async () => {
                if (!searchQuery.trim() || !isUrl(searchQuery) || !selectedFormat) return;

                setDownloading(true);
                setDownloadProgress(0);
                
                try {
                    const response = await fetch('http://localhost:8000/api/youtube/download-video', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ url: searchQuery, format_id: selectedFormat })
                    });

                    if (!response.ok) throw new Error('Download failed');

                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = 'video.mp4';
                    if (contentDisposition) {
                        const patterns = [
                            /filename\*=UTF-8''(.+)/,
                            /filename="(.+)"/,
                            /filename=([^;\n]+)/
                        ];
                        
                        for (const pattern of patterns) {
                            const match = contentDisposition.match(pattern);
                            if (match && match[1]) {
                                filename = decodeURIComponent(match[1].trim());
                                break;
                            }
                        }
                    }

                    if (filename === 'video.mp4' && selectedVideo) {
                        const safeTitle = selectedVideo.title.replace(/[^a-z0-9]/gi, '_').replace(/_+/g, '_');
                        filename = `${safeTitle}.mp4`;
                    }

                    const contentLength = response.headers.get('Content-Length');
                    const total = parseInt(contentLength, 10);
                    let loaded = 0;

                    const reader = response.body.getReader();
                    const chunks = [];

                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        
                        chunks.push(value);
                        loaded += value.length;
                        
                        if (total) {
                            const progress = Math.round((loaded / total) * 100);
                            setDownloadProgress(progress);
                        }
                    }

                    const blob = new Blob(chunks);
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    setTimeout(() => {
                        alert('Download complete! âœ…');
                        setSearchQuery('');
                        setSearchResults([]);
                        setSelectedVideo(null);
                        setAvailableFormats([]);
                        setDownloadProgress(0);
                    }, 500);
                } catch (error) {
                    alert('Download failed: ' + error.message);
                    setDownloadProgress(0);
                }
                setDownloading(false);
            };

            const handleCardClick = async (video) => {
                setSearchQuery(video.url);
                setSelectedVideo(video);
                setSearchResults([]);
                await fetchFormats(video.url);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex items-center mb-8">
                            <button 
                                onClick={() => { setCurrentPage('home'); setSearchQuery(''); setSearchResults([]); setSelectedVideo(null); }}
                                className="mr-6 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-colors border border-white/20"
                            >
                                <HomeIcon />
                            </button>
                            <h1 className="text-4xl font-bold text-white flex items-center gap-3">
                                <VideoIcon className="w-10 h-10 text-blue-400" />
                                YouTube Video Downloader
                            </h1>
                        </div>

                        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-8 border border-white/20">
                            <div className="flex gap-3 mb-4">
                                <input
                                    type="text"
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                    placeholder="Search for videos or paste YouTube URL..."
                                    className="flex-1 bg-white/10 border border-white/20 rounded-xl px-6 py-4 text-white placeholder-purple-200/50 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                />
                                {searchQuery && (
                                    <button
                                        onClick={handleClear}
                                        className="bg-red-600 hover:bg-red-700 p-4 rounded-xl text-white transition-colors"
                                        title="Clear"
                                    >
                                        <ClearIcon />
                                    </button>
                                )}
                                <button
                                    onClick={isUrl(searchQuery) && selectedVideo && selectedFormat ? handleDownload : handleSearch}
                                    disabled={loading || downloading || !searchQuery.trim()}
                                    className="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 px-8 py-4 rounded-xl text-white font-semibold transition-colors disabled:cursor-not-allowed"
                                >
                                    {downloading ? 'Downloading...' : loading ? 'Loading...' : isUrl(searchQuery) && selectedVideo && selectedFormat ? 'Download' : isUrl(searchQuery) ? 'Fetch Info' : 'Search'}
                                </button>
                            </div>

                            {/* Quality Selection */}
                            {availableFormats.length > 0 && (
                                <div className="mt-4">
                                    <label className="text-white font-semibold mb-2 block">Select Quality:</label>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        {availableFormats.map((format) => (
                                            <button
                                                key={format.format_id}
                                                onClick={() => setSelectedFormat(format.format_id)}
                                                className={`p-3 rounded-xl border-2 transition-all ${
                                                    selectedFormat === format.format_id
                                                        ? 'bg-blue-600 border-blue-400 text-white'
                                                        : 'bg-white/10 border-white/20 text-purple-200 hover:bg-white/20'
                                                }`}
                                            >
                                                <div className="font-bold text-lg">{format.resolution}</div>
                                                <div className="text-xs opacity-80">{format.filesize}</div>
                                                <div className="text-xs opacity-60">{format.fps} fps</div>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {loadingFormats && (
                                <div className="mt-4 text-center text-purple-200">
                                    Loading available qualities...
                                </div>
                            )}
                            
                            {downloading && (
                                <div className="mt-4">
                                    <div className="w-full bg-white/10 rounded-full h-3 overflow-hidden">
                                        <div 
                                            className="bg-gradient-to-r from-blue-500 to-purple-500 h-full transition-all duration-300"
                                            style={{ width: `${downloadProgress}%` }}
                                        />
                                    </div>
                                    <p className="text-purple-200 text-sm text-center mt-2">{downloadProgress}%</p>
                                </div>
                            )}
                        </div>

                        {selectedVideo && (
                            <div className="mb-8 flex justify-center">
                                <div className="bg-white/10 backdrop-blur-lg rounded-xl overflow-hidden border border-white/20 max-w-md w-full">
                                    <div className="relative pb-[56.25%]">
                                        <img src={selectedVideo.thumbnail} alt={selectedVideo.title} className="absolute inset-0 w-full h-full object-cover" />
                                    </div>
                                    <div className="p-4">
                                        <h3 className="text-white font-semibold mb-2">{selectedVideo.title}</h3>
                                        <p className="text-purple-200 text-sm mb-1">{selectedVideo.channel}</p>
                                        <p className="text-purple-300 text-sm">{selectedVideo.duration}</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {searchResults.length > 0 && (
                            <div>
                                <h2 className="text-2xl font-bold text-white mb-4">Search Results</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {searchResults.map((result) => (
                                        <div
                                            key={result.id}
                                            onClick={() => handleCardClick(result)}
                                            className="bg-white/10 backdrop-blur-lg rounded-xl overflow-hidden cursor-pointer hover:bg-white/20 transition-all hover:scale-105 border border-white/20"
                                        >
                                            <div className="relative pb-[56.25%]">
                                                <img src={result.thumbnail} alt={result.title} className="absolute inset-0 w-full h-full object-cover" />
                                            </div>
                                            <div className="p-4">
                                                <h3 className="text-white font-semibold mb-2 line-clamp-2">{result.title}</h3>
                                                <p className="text-purple-200 text-sm mb-1">{result.channel}</p>
                                                <p className="text-purple-300 text-sm">{result.duration}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {searchResults.length === 0 && !loading && !selectedVideo && (
                            <div className="text-center py-20">
                                <VideoIcon className="w-20 h-20 text-purple-300/30 mx-auto mb-4" />
                                <p className="text-purple-200/50 text-lg">Search for videos or paste a YouTube URL to get started</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // CONVERTER PAGE
        const ConverterPage = ({ setCurrentPage }) => {
            const [inputText, setInputText] = useState('');
            const [outputText, setOutputText] = useState('');
            const [mode, setMode] = useState('xml-to-json'); // or 'json-to-xml'
            const [loading, setLoading] = useState(false);

            const handleConvert = async () => {
                if (!inputText.trim()) {
                    alert('Please enter some content to convert');
                    return;
                }

                setLoading(true);
                try {
                    const endpoint = mode === 'xml-to-json' ? 'xml-to-json' : 'json-to-xml';
                    const response = await fetch(`http://localhost:8000/api/converter/${endpoint}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ content: inputText })
                    });

                    const data = await response.json();
                    if (response.ok) {
                        setOutputText(data.converted);
                    } else {
                        alert('Conversion failed: ' + data.detail);
                    }
                } catch (error) {
                    alert('Error: ' + error.message);
                }
                setLoading(false);
            };

            const handleSwap = () => {
                setInputText(outputText);
                setOutputText('');
                setMode(mode === 'xml-to-json' ? 'json-to-xml' : 'xml-to-json');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex items-center mb-8">
                            <button 
                                onClick={() => setCurrentPage('home')}
                                className="mr-6 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-colors border border-white/20"
                            >
                                <HomeIcon />
                            </button>
                            <h1 className="text-4xl font-bold text-white flex items-center gap-3">
                                <CodeIcon className="w-10 h-10 text-green-400" />
                                XML/JSON Converter
                            </h1>
                        </div>

                        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6 border border-white/20">
                            <div className="flex gap-4 mb-4">
                                <button
                                    onClick={() => setMode('xml-to-json')}
                                    className={`flex-1 py-3 px-6 rounded-xl font-semibold transition-colors ${
                                        mode === 'xml-to-json' 
                                            ? 'bg-green-600 text-white' 
                                            : 'bg-white/10 text-purple-200 hover:bg-white/20'
                                    }`}
                                >
                                    XML â†’ JSON
                                </button>
                                <button
                                    onClick={() => setMode('json-to-xml')}
                                    className={`flex-1 py-3 px-6 rounded-xl font-semibold transition-colors ${
                                        mode === 'json-to-xml' 
                                            ? 'bg-green-600 text-white' 
                                            : 'bg-white/10 text-purple-200 hover:bg-white/20'
                                    }`}
                                >
                                    JSON â†’ XML
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                                <h3 className="text-xl font-bold text-white mb-4">
                                    Input ({mode === 'xml-to-json' ? 'XML' : 'JSON'})
                                </h3>
                                <textarea
                                    value={inputText}
                                    onChange={(e) => setInputText(e.target.value)}
                                    placeholder={mode === 'xml-to-json' ? 'Paste your XML here...' : 'Paste your JSON here...'}
                                    className="w-full h-96 bg-white/10 border border-white/20 rounded-xl p-4 text-white placeholder-purple-200/50 focus:outline-none focus:ring-2 focus:ring-green-400 font-mono text-sm"
                                />
                            </div>

                            <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                                <h3 className="text-xl font-bold text-white mb-4">
                                    Output ({mode === 'xml-to-json' ? 'JSON' : 'XML'})
                                </h3>
                                <textarea
                                    value={outputText}
                                    readOnly
                                    placeholder="Converted output will appear here..."
                                    className="w-full h-96 bg-white/10 border border-white/20 rounded-xl p-4 text-white placeholder-purple-200/50 font-mono text-sm"
                                />
                            </div>
                        </div>

                        <div className="flex gap-4 mt-6 justify-center">
                            <button
                                onClick={handleConvert}
                                disabled={loading || !inputText.trim()}
                                className="bg-green-600 hover:bg-green-700 disabled:bg-gray-600 px-12 py-4 rounded-xl text-white font-semibold transition-colors disabled:cursor-not-allowed"
                            >
                                {loading ? 'Converting...' : 'Convert'}
                            </button>
                            <button
                                onClick={handleSwap}
                                disabled={!outputText}
                                className="bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 px-12 py-4 rounded-xl text-white font-semibold transition-colors disabled:cursor-not-allowed"
                            >
                                Swap & Convert Back
                            </button>
                            <button
                                onClick={() => { setInputText(''); setOutputText(''); }}
                                className="bg-red-600 hover:bg-red-700 px-12 py-4 rounded-xl text-white font-semibold transition-colors"
                            >
                                Clear All
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('app'));
        root.render(<App />);
    </script>
</body>
</html>